<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì´ˆê°„ë‹¨ ë¹„ê±´ ë””ì €íŠ¸ ê°€ì´ë“œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/reset-css@5.0.2/reset.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
      margin: 2rem;
      background-color: #f8f6f4;
      color: #333;
    }
    h1 {
      font-size: 1.8rem;
      margin-bottom: 0.8rem;
      text-align: center;
      background-color: #d6bfa7;
      color: white;
      padding: 1rem;
      border-radius: 1rem;
    }
    p {
      max-width: 600px;
      margin: 0 auto 2rem;
      background-color: #e9f2e3;
      padding: 1rem;
      border-radius: 1rem;
    }
    .season-buttons {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }
    .season-button {
      padding: 0.4rem 1rem;
      border: none;
      border-radius: 1rem;
      background: #eee;
      cursor: pointer;
      transition: 0.2s;
    }
    .season-button.active {
      background-color: #84d4b8;
      font-weight: bold;
      color: white;
    }
    .thumbnail {
      cursor: pointer;
      font-weight: bold;
      border: 1px solid #ccc;
      padding: 0.5rem;
      background-color: #fff;
      width: fit-content;
      margin: 0 auto;
    }
    .recipe-detail {
      margin-top: 1rem;
      padding: 1rem;
      border: 1px solid #ccc;
      background-color: #fff;
      border-radius: 1rem;
      max-width: 600px;
      margin: 0 auto;
    }
    h3 {
      text-align: center;
      margin-top: 3rem;
    }
    form {
      margin-top: 1rem;
      padding: 1rem;
      border: 1px solid #ccc;
      background-color: #fff;
      max-width: 600px;
      margin: 1rem auto;
      border-radius: 1rem;
    }
    textarea {
      width: 100%;
      height: 4rem;
      margin-top: 0.5rem;
      padding: 0.5rem;
      border-radius: 0.5rem;
      border: 1px solid #ccc;
    }
    .comment-rating {
      color: #f5b301;
      margin-right: 0.5rem;
    }
    .comment-item {
      margin: 0.5rem 0;
      display: flex;
      align-items: center;
    }
    #commentsList {
      margin-top: 1rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    button[type="submit"] {
      margin-top: 0.5rem;
      background-color: #d6bfa7;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 1rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>ì´ˆê°„ë‹¨ ë¹„ê±´ ë””ì €íŠ¸ ê°€ì´ë“œ</h1>
  <p>
    ë¹„ê±´ ë””ì €íŠ¸ëŠ” ìœ ì œí’ˆê³¼ ë‹¬ê±€ ì—†ì´ë„ ê°€ë³ê³  ì†Œí™”ê°€ ì˜ ë˜ë©°, ì•Œë ˆë¥´ê¸°ë‚˜ ì‹ì´ ì œí•œì´ ìˆëŠ” ì‚¬ëŒë“¤ë„ ì•ˆì‹¬í•˜ê³  ì¦ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
    ë˜í•œ ë™ë¬¼ì„± ì¬ë£Œë¥¼ ì“°ì§€ ì•Šì•„ í™˜ê²½ ë¶€ë‹´ì„ ì¤„ì´ê³ , ì§€ì†ê°€ëŠ¥í•œ ì‹ìŠµê´€ìœ¼ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤. 
    ì‹ë¬¼ì„± ì¬ë£Œ ì¤‘ì‹¬ì´ë¼ ì‹ì´ì„¬ìœ ì™€ ì˜ì–‘ì´ í’ë¶€í•´ ê±´ê°•í•œ ê°„ì‹ìœ¼ë¡œë„ ì¢‹ì•„ìš”. 
    ê°„ë‹¨í•œ ë¹„ê±´ ë² ì´í‚¹ìœ¼ë¡œ ê±´ê°•í•œ ì·¨ë¯¸ë¥¼ ì¦ê²¨ë³´ì„¸ìš”!
  </p>

  <div class="season-buttons">
    <button class="season-button" onclick="showSeason('spring')">ë´„</button>
    <button class="season-button" onclick="showSeason('summer')">ì—¬ë¦„</button>
    <button class="season-button" onclick="showSeason('autumn')">ê°€ì„</button>
    <button class="season-button" onclick="showSeason('winter')">ê²¨ìš¸</button>
  </div>

  <div id="spring" class="recipe-thumbnails">
    <div class="thumbnail" onclick="showRecipe('matcha')">
      <img src="https://source.unsplash.com/featured/?matcha,latte" alt="ë§ì°¨ ë¼ë–¼" width="200">
    </div>
  </div>

  <div id="matcha" class="recipe-detail">
    <h2>ë§ì°¨ ë¼ë–¼</h2>
    <p>ë¹„ê±´ ë§ì°¨ ë¼ë–¼ ë§Œë“œëŠ” ë²•.</p>
    <button onclick="backToThumbnails('spring')">ëª©ë¡ìœ¼ë¡œ</button>
  </div>

  <h3>ë°œìêµ­ì„ ë‚¨ê²¨ì£¼ì„¸ìš”! ğŸƒğŸƒğŸƒ</h3>
  <form id="commentForm" onsubmit="addComment(event)">
    <label><input type="radio" name="rating" value="1">â˜…</label>
    <label><input type="radio" name="rating" value="2">â˜…â˜…</label>
    <label><input type="radio" name="rating" value="3">â˜…â˜…â˜…</label>
    <label><input type="radio" name="rating" value="4">â˜…â˜…â˜…â˜…</label>
    <label><input type="radio" name="rating" value="5">â˜…â˜…â˜…â˜…â˜…</label><br>
    <textarea id="commentInput" placeholder="ë‚´ìš© ì‘ì„±"></textarea><br>
    <button type="submit">ì „ì†¡</button>
  </form>
  <div id="commentsList"></div>

  <script>
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzBEFXoCmwB-TqUpZQ0Ar1Ezj8AsKgeClKKGVByhXcvbeQX1D2YFJbzJzFqGl5TTCWZKA/exec';

    function sendDataToSheet(eventData) {
      fetch(APPS_SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(eventData)
      })
      .then(() => console.log('Data sent successfully'))
      .catch(err => console.error('Error sending data:', err));
    }

    let currentSeason = '';
    let currentRecipe = '';

    function showSeason(season) {
      currentSeason = season;
      currentRecipe = '';

      document.querySelectorAll('.season-button').forEach(btn => {
        btn.classList.toggle('active', btn.textContent.trim() === season);
      });

      document.querySelectorAll('.recipe-thumbnails, .recipe-detail').forEach(el => {
        el.style.display = 'none';
      });

      const seasonThumbs = document.getElementById(season);
      if (seasonThumbs) seasonThumbs.style.display = 'block';
    }

    function showRecipe(id) {
      currentRecipe = id;
      if (currentSeason) {
        const thumbs = document.getElementById(currentSeason);
        if (thumbs) thumbs.style.display = 'none';
      }

      document.querySelectorAll('.recipe-detail').forEach(el => el.style.display = 'none');
      const recipe = document.getElementById(id);
      if (recipe) {
        recipe.style.display = 'block';
        sendDataToSheet({ type: 'recipe_click', detail: id });
      }
    }

    function backToThumbnails(season) {
      currentRecipe = '';
      document.querySelectorAll('.recipe-detail').forEach(el => el.style.display = 'none');
      const thumbs = document.getElementById(season);
      if (thumbs) thumbs.style.display = 'block';
      showSeason(season);
    }

    function loadComments() {
      const comments = JSON.parse(localStorage.getItem('comments') || '[]');
      const commentsList = document.getElementById('commentsList');
      commentsList.innerHTML = '';
      comments.forEach(c => {
        const item = document.createElement('div');
        item.className = 'comment-item';
        item.innerHTML = `<span class="comment-rating">${'â˜…'.repeat(c.rating)}${'â˜†'.repeat(5 - c.rating)}</span><span class="comment-text">${c.text}</span>`;
        commentsList.appendChild(item);
      });
    }

    function addComment(event) {
      event.preventDefault();
      const ratingInput = document.querySelector('input[name="rating"]:checked');
      const commentInput = document.getElementById('commentInput');
      const rating = ratingInput ? ratingInput.value : null;
      const commentText = commentInput.value.trim();

      if (!rating || !commentText) {
        alert('ë³„ì ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      const comments = JSON.parse(localStorage.getItem('comments') || '[]');
      comments.push({ rating: parseInt(rating), text: commentText });
      localStorage.setItem('comments', JSON.stringify(comments));

      sendDataToSheet({ type: 'comment', detail: `rating: ${rating}, comment: ${commentText}` });

      document.getElementById('commentForm').reset();
      loadComments();
    }

    window.onload = () => {
      loadComments();
      showSeason('spring');
    };
  </script>
</body>
</html>
